# èšåˆè§£ææµåª’ä½“å¹³å°é“¾æ¥ï¼Œè½¬æ¢ä¸ºåª’ä½“ç›´é“¾å‘é€

AstrBot æ’ä»¶ï¼Œæ”¯æŒè‡ªåŠ¨è§£ææµåª’ä½“å¹³å°é“¾æ¥ï¼Œè·å–åª’ä½“å…ƒæ•°æ®è½¬æ¢ä¸ºç›´é“¾å‘é€

---

## ğŸ“º æ”¯æŒçš„æµåª’ä½“å¹³å°

<table class="config-table">
<thead>
<tr>
<th>å¹³å°</th>
<th>æ”¯æŒçš„é“¾æ¥ç±»å‹</th>
<th>å¯è§£æçš„åª’ä½“ç±»å‹</th>
</tr>
</thead>
<tbody>
<tr>
<td class="center"><strong>Bç«™</strong></td>
<td>çŸ­é“¾ï¼ˆ<code>b23.tv/...</code>ï¼‰<br>è§†é¢‘avå·ï¼ˆ<code>www.bilibili.com/video/av...</code>ï¼‰<br>è§†é¢‘BVå·ï¼ˆ<code>www.bilibili.com/video/BV...</code>ï¼‰<br>åŠ¨æ€é•¿é“¾ï¼ˆ<code>www.bilibili.com/opus/...</code>ï¼‰<br>åŠ¨æ€çŸ­é“¾ï¼ˆ<code>t.bilibili.com/...</code>ï¼‰<br>å°ç¨‹åºå¡ç‰‡ï¼ˆ<code>message.meta.detail_1.qqdocurl</code>ï¼‰</td>
<td class="center">è§†é¢‘ã€å›¾ç‰‡</td>
</tr>
<tr>
<td class="center"><strong>æŠ–éŸ³</strong></td>
<td>çŸ­é“¾ï¼ˆ<code>v.douyin.com/...</code>ï¼‰<br>è§†é¢‘é•¿é“¾ï¼ˆ<code>www.douyin.com/video/...</code>ï¼‰<br>å›¾é›†é•¿é“¾ï¼ˆ<code>www.douyin.com/note/...</code>ï¼‰</td>
<td class="center">è§†é¢‘ã€å›¾ç‰‡</td>
</tr>
<tr>
<td class="center"><strong>å¿«æ‰‹</strong></td>
<td>çŸ­é“¾ï¼ˆ<code>v.kuaishou.com/...</code>ï¼‰<br>è§†é¢‘é•¿é“¾ï¼ˆ<code>www.kuaishou.com/short-video/...</code>ï¼‰</td>
<td class="center">è§†é¢‘ã€å›¾ç‰‡</td>
</tr>
<tr>
<td class="center"><strong>å¾®åš</strong></td>
<td>æ¡Œé¢ç«¯åšå®¢é“¾æ¥ï¼ˆ<code>weibo.com/...</code>ï¼‰<br>ç§»åŠ¨ç«¯åšå®¢é“¾æ¥ï¼ˆ<code>m.weibo.cn/detail/...</code>ï¼‰<br>ç§»åŠ¨ç«¯è§†é¢‘åˆ†äº«é“¾æ¥ï¼ˆ<code>video.weibo.com/show?fid=...</code>ï¼‰<br>è§†é¢‘åˆ†äº«é“¾æ¥é‡å®šå‘ï¼ˆ<code>weibo.com/tv/show/...</code>ï¼‰<br>å°ç¨‹åºå¡ç‰‡ï¼ˆ<code>message.meta.detail_1.qqdocurl</code>ï¼‰</td>
<td class="center">è§†é¢‘ã€å›¾ç‰‡</td>
</tr>
<tr>
<td class="center"><strong>å°çº¢ä¹¦</strong></td>
<td>çŸ­é“¾ï¼ˆ<code>xhslink.com/...</code>ï¼‰<br>ç¬”è®°é•¿é“¾ï¼ˆ<code>www.xiaohongshu.com/explore/...</code>ï¼‰<br>ç¬”è®°é•¿é“¾ï¼ˆ<code>www.xiaohongshu.com/discovery/item/...</code>ï¼‰<br>å°ç¨‹åºå¡ç‰‡ï¼ˆ<code>message.meta.news.jumpUrl</code>ï¼‰</td>
<td class="center">è§†é¢‘ã€å›¾ç‰‡</td>
</tr>
<tr>
<td class="center"><strong>å°é»‘ç›’</strong></td>
<td>Webé“¾æ¥ï¼ˆ<code>www.xiaoheihe.cn/app/topic/game/...</code>ï¼‰<br>Appåˆ†äº«é“¾æ¥ï¼ˆ<code>api.xiaoheihe.cn/game/share_game_detail?...</code>ï¼‰<br>å°ç¨‹åºå¡ç‰‡ï¼ˆ<code>message.meta.news.jumpUrl</code>ï¼‰</td>
<td class="center">æ¸¸æˆé¡µè¯¦æƒ…</td>
</tr>
<tr>
<td class="center"><strong>æ¨ç‰¹</strong></td>
<td>twitter é“¾æ¥ï¼ˆ<code>twitter.com/.../status/...</code>ï¼‰<br>x é“¾æ¥ï¼ˆ<code>x.com/.../status/...</code>ï¼‰</td>
<td class="center">è§†é¢‘ã€å›¾ç‰‡</td>
</tr>
</tbody>
</table>

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å®‰è£…

1. **ä¾èµ–åº“**ï¼šæ‰“å¼€ AstrBot WebUI â†’ æ§åˆ¶å° â†’ å®‰è£… Pip åº“ï¼Œè¾“å…¥ `aiohttp` å¹¶å®‰è£…
2. **æ’ä»¶**ï¼šæ‰“å¼€ AstrBot WebUI â†’ æ’ä»¶å¸‚åœºæœç´¢ `astrbot_plugin_media_parser` å¹¶å®‰è£…

### ç‰¹æ€§

- âœ… æ— éœ€é…ç½®ä»»ä½• cookie
- âœ… è‡ªåŠ¨è¯†åˆ«å¹¶è§£æé“¾æ¥

---

## âš™ï¸ ä¼˜åŒ–ä½“éªŒ

é…ç½® **ç¼“å­˜ç›®å½•** å’Œæ‰“å¼€ **é¢„ä¸‹è½½æ¨¡å¼** å¯æ˜¾è‘—æå‡è§£ææˆåŠŸç‡å’Œå‘é€ä½“éªŒã€‚

> **åŸå› **ï¼šæ¶ˆæ¯å¹³å°ä½¿ç”¨ç›´é“¾å‘é€åª’ä½“æ—¶æ— æ³•æŒ‡å®š headerã€refererã€cookie ç­‰å‚æ•°ï¼Œéƒ¨åˆ†é£æ§ä¸¥æ ¼çš„å¹³å°ä¼šè¿”å› 403 Forbiddenã€‚  
> **å»ºè®®**ï¼šåŒæ—¶é…ç½®ç¼“å­˜ç›®å½•å’Œå¼€å¯é¢„ä¸‹è½½æ¨¡å¼ã€‚

### å„å¹³å°ç‰¹æ®Šæƒ…å†µ

**ç¡¬æ€§è¦æ±‚ï¼ˆå¿…é¡»é¢„ä¸‹è½½ï¼‰**
- **å¾®åš**ï¼šæ‰€æœ‰è§†é¢‘å¿…é¡»æ­£ç¡®æºå¸¦ referer å‚æ•°æ‰èƒ½ä¸‹è½½
- **å°é»‘ç›’**ï¼šM3U8 æ ¼å¼å¿…é¡»å°†éŸ³è§†é¢‘åˆ†ç‰‡ä¸‹è½½åˆ°æœ¬åœ°å†åˆå¹¶

**æ¦‚ç‡é£æ§ï¼ˆå»ºè®®é¢„ä¸‹è½½ï¼‰**
- **å°çº¢ä¹¦**ï¼šéƒ¨åˆ†åª’ä½“ä½¿ç”¨ URL å‘é€æœ‰æ¦‚ç‡é£æ§

**æé«˜æ€§èƒ½ï¼ˆå¯é€‰ï¼‰**
- **Bç«™ã€Twitter/X**ï¼šæ”¯æŒ Range è¯·æ±‚ï¼Œé…ç½®ç¼“å­˜ç›®å½•åå¯å¹¶å‘ä¸‹è½½æå‡é€Ÿåº¦

> ğŸ’¡ Range ä¸‹è½½ä»…ä¸ºæ€§èƒ½ä¼˜åŒ–ï¼Œæœªé…ç½®ç¼“å­˜ç›®å½•æ—¶ä¼šè‡ªåŠ¨é€€åŒ–ä¸ºå•æ–‡ä»¶ä¸‹è½½æ¨¡å¼

---

## ğŸ“ æ³¨æ„äº‹é¡¹

- **Bç«™**ï¼šè½¬å‘åŠ¨æ€ä¼šä½¿ç”¨ ```"è½¬å‘åŠ¨æ€æ•°æ®ï¼ˆåŸå§‹åŠ¨æ€æ•°æ®ï¼‰"``` ç»„ç»‡æ–‡æœ¬æ ¼å¼è§£æç»“æœ
- **å°çº¢ä¹¦**ï¼šé“¾æ¥æœ‰èº«ä»½éªŒè¯å’Œæ—¶æ•ˆæ€§ï¼Œåˆ†äº«é“¾æ¥è§£æç»“æœæœ‰æ°´å°
- **å°é»‘ç›’**ï¼šä¸æºå¸¦ token åªèƒ½è§£ææ¸¸æˆé¡µè¯¦æƒ…ï¼Œæ¸¸æˆé¢„è§ˆè§†é¢‘ä¸‹è½½é€Ÿåº¦ä¸ä½³æ—¶è¯·å¯ç”¨ä»£ç†
- **æ¨ç‰¹**ï¼šè§£æ api ä½¿ç”¨ fxtwitter æœåŠ¡å¯ç›´è¿ï¼Œå›¾ç‰‡ cdn å¤§å¤šè¢«å¢™å»ºè®®å¼€å¯ä»£ç†ï¼Œè§†é¢‘ cdn ~~å¯ç›´è¿~~ è¿‘æœŸå¤§å¤šè¢«å¢™å»ºè®®å¼€å¯ä»£ç†
- **å›¾ç‰‡å¤„ç†** æ ¼å¼é™¤ ```.jpg```, ```.jpeg```, ```.png``` å¤–çš„æ‰€æœ‰å›¾ç‰‡ä¼šå…ˆè½¬æ¢ä¸º ```.png``` æ ¼å¼å†å‘é€
- **å…¶ä»–**ï¼šæ’ä»¶ä¼šè·³è¿‡åŒ…å« `"åŸå§‹é“¾æ¥ï¼š"` å­—æ®µçš„æ¶ˆæ¯ï¼Œé˜²æ­¢é‡å¤è§£æ

---

## ğŸ™ é¸£è°¢

- [bilibili-API-collect](https://github.com/SocialSisterYi/bilibili-API-collect) - Bç«™è§£æç«¯ç‚¹
- [FxEmbed](https://github.com/FxEmbed/FxEmbed) - æ¨ç‰¹è§£ææœåŠ¡
- [tianger-mckz](https://github.com/drdon1234/astrbot_plugin_bilibili_bot/issues/1#issuecomment-3517087034) | [ScryAbu](https://github.com/drdon1234/astrbot_plugin_media_parser/issues/16#issuecomment-3726729850) | [WWWA7](https://github.com/drdon1234/astrbot_plugin_media_parser/pull/17#issue-3799325283) - QQå°ç¨‹åºå¡ç‰‡é“¾æ¥æå–æ–¹æ³•
- [CSDN åšå®¢](https://blog.csdn.net/qq_53153535/article/details/141297614) - æŠ–éŸ³è§£ææ–¹æ³•
